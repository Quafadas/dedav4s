<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Laika 0.18.1 + Helium Theme" />
    <title>Scala JS</title>
    
      <meta name="author" content="Simon Parten"/>
    
    
      <meta name="description" content="Declarative data visualisation for scala"/>
    
    
    
      <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700">
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/tonsky/FiraCode@1.207/distr/fira_code.css">
    
    <link rel="stylesheet" type="text/css" href="../helium/icofont.min.css" />
    <link rel="stylesheet" type="text/css" href="../helium/laika-helium.css" />
    <link rel="stylesheet" type="text/css" href="../site/styles.css" />
    <script src="../helium/laika-helium.js"></script>
    
    
    <script> /* for avoiding page load transitions */ </script>
    <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-lite@5"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>
  </head>

  <body>

    <header id="top-bar">

      <div class="row">
        <a id="nav-icon">
          <i class="icofont-laika" title="Navigation">&#xefa2;</i>
        </a>
        
      </div>

      <a class="icon-link" href="index.html"><i class="icofont-laika" title="Home">î½‡</i></a>

      <span class="row links"><a class="icon-link" href="https://github.com/Quafadas/dedav4s"><span title="Source Code"><svg class="svg-icon" width="100%" height="100%" viewBox="0 0 100 100" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;">
  <g class="svg-shape">
    <path d="M49.995,1c-27.609,-0 -49.995,22.386 -49.995,50.002c-0,22.09 14.325,40.83 34.194,47.444c2.501,0.458 3.413,-1.086 3.413,-2.412c0,-1.185 -0.043,-4.331 -0.067,-8.503c-13.908,3.021 -16.843,-6.704 -16.843,-6.704c-2.274,-5.773 -5.552,-7.311 -5.552,-7.311c-4.54,-3.103 0.344,-3.042 0.344,-3.042c5.018,0.356 7.658,5.154 7.658,5.154c4.46,7.64 11.704,5.433 14.552,4.156c0.454,-3.232 1.744,-5.436 3.174,-6.685c-11.102,-1.262 -22.775,-5.553 -22.775,-24.713c-0,-5.457 1.949,-9.92 5.147,-13.416c-0.516,-1.265 -2.231,-6.348 0.488,-13.233c0,0 4.199,-1.344 13.751,5.126c3.988,-1.108 8.266,-1.663 12.518,-1.682c4.245,0.019 8.523,0.574 12.517,1.682c9.546,-6.47 13.736,-5.126 13.736,-5.126c2.728,6.885 1.013,11.968 0.497,13.233c3.204,3.496 5.141,7.959 5.141,13.416c0,19.209 -11.691,23.436 -22.83,24.673c1.795,1.544 3.394,4.595 3.394,9.26c0,6.682 -0.061,12.076 -0.061,13.715c0,1.338 0.899,2.894 3.438,2.406c19.853,-6.627 34.166,-25.354 34.166,-47.438c-0,-27.616 -22.389,-50.002 -50.005,-50.002"/>
  </g>
</svg></span></a></span>

    </header>

    <nav id="sidebar">

      <div class="row">
        <a class="icon-link" href="https://github.com/Quafadas/dedav4s"><span title="Source Code"><svg class="svg-icon" width="100%" height="100%" viewBox="0 0 100 100" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;">
  <g class="svg-shape">
    <path d="M49.995,1c-27.609,-0 -49.995,22.386 -49.995,50.002c-0,22.09 14.325,40.83 34.194,47.444c2.501,0.458 3.413,-1.086 3.413,-2.412c0,-1.185 -0.043,-4.331 -0.067,-8.503c-13.908,3.021 -16.843,-6.704 -16.843,-6.704c-2.274,-5.773 -5.552,-7.311 -5.552,-7.311c-4.54,-3.103 0.344,-3.042 0.344,-3.042c5.018,0.356 7.658,5.154 7.658,5.154c4.46,7.64 11.704,5.433 14.552,4.156c0.454,-3.232 1.744,-5.436 3.174,-6.685c-11.102,-1.262 -22.775,-5.553 -22.775,-24.713c-0,-5.457 1.949,-9.92 5.147,-13.416c-0.516,-1.265 -2.231,-6.348 0.488,-13.233c0,0 4.199,-1.344 13.751,5.126c3.988,-1.108 8.266,-1.663 12.518,-1.682c4.245,0.019 8.523,0.574 12.517,1.682c9.546,-6.47 13.736,-5.126 13.736,-5.126c2.728,6.885 1.013,11.968 0.497,13.233c3.204,3.496 5.141,7.959 5.141,13.416c0,19.209 -11.691,23.436 -22.83,24.673c1.795,1.544 3.394,4.595 3.394,9.26c0,6.682 -0.061,12.076 -0.061,13.715c0,1.338 0.899,2.894 3.438,2.406c19.853,-6.627 34.166,-25.354 34.166,-47.438c-0,-27.616 -22.389,-50.002 -50.005,-50.002"/>
  </g>
</svg></span></a>
      </div>

      <ul class="nav-list">
        <li class="level1 nav-header">Getting Sarted</li>
        <li class="level2"><a href="../gettingStarted/gettingStarted.html">Getting Started</a></li>
        <li class="level2"><a href="../gettingStarted/resources.html">Links</a></li>
        <li class="level1 nav-header">Details</li>
        <li class="level2"><a href="../explanation/chartTypes.html">Example Charts</a></li>
        <li class="level2"><a href="../explanation/plotTargets.html">Plot Targets</a></li>
        <li class="level2"><a href="../explanation/rawDataTypes.html">&quot;Raw&quot; Data &amp; Extension Methods</a></li>
        <li class="level2"><a href="../explanation/customising.html">Customising an existing data structure</a></li>
        <li class="level2"><a href="../explanation/outFiles.html">Where do the temporary files live?</a></li>
        <li class="level1 nav-header">Working With A Chart</li>
        <li class="level2"><a href="../working_chart/intro.html">Styles</a></li>
        <li class="level2"><a href="../working_chart/mutable.html">Mutable Style</a></li>
        <li class="level2"><a href="../working_chart/typesafe.html">The DSL</a></li>
        <li class="level2"><a href="../working_chart/mixed.html">Mixed typesafe / mutable</a></li>
        <li class="level2"><a href="../working_chart/chartSources.html">Chart Sources</a></li>
        <li class="level1 nav-header">Scala Versions</li>
        <li class="level2"><a href="scalaVersions.html">Scala Versions</a></li>
        <li class="level2 active"><a href="#">Scala JS</a></li>
        <li class="level1 nav-header">Prior Art</li>
        <li class="level2"><a href="../priorArt/philosophy.html">Prior Art</a></li>
      </ul>

      <ul class="nav-list">
        <li class="level1 nav-header">Related Projects</li>
        
          <li class="level2"><a href="https://typelevel.org/cats/">cats</a></li>
        
      </ul>

    </nav>

    <div id="container">

      <nav id="page-nav">
        <p class="header"><a href="#">Scala JS</a></p>

        <ul class="nav-list">
          <li class="level1"><a href="#scala-js-ui-frameworks">Scala JS UI frameworks</a></li>
          <li class="level1"><a href="#integrations">Integrations</a></li>
          <li class="level2"><a href="#laminar">Laminar</a></li>
          <li class="level2"><a href="#calico">Calico</a></li>
          <li class="level2"><a href="#mdoc">MDoc</a></li>
          <li class="level2"><a href="#laika-with-mdoc">Laika with mdoc</a></li>
          <li class="level1"><a href="#conclusion">Conclusion</a></li>
          <li class="level2"><a href="#javascript-libraries">Javascript libraries</a></li>
        </ul>

        <p class="footer"></p>
      </nav>

      <main class="content">

        <h1 id="scala-js" class="title">Scala JS</h1>
        
        <h2 id="scala-js-ui-frameworks" class="section"><a class="anchor-link left" href="#scala-js-ui-frameworks"><i class="icofont-laika">&#xef71;</i></a>Scala JS UI frameworks</h2>
        <p>It turns out, that scala JS Dom is simply a facade for the browser API. Dedav works, through providing a reference to a scala js dom Div element.</p>
        <p>Due to how fundamental the statement above is, we implicitly support <em>all</em> JS UI frameworks. It must be possible to coerce the DIV wrapper of your framework into a scala js dom Div. However, as I use some frameworks myself, it&#39;s a little easier to get started ...</p>
        
        <h2 id="integrations" class="section"><a class="anchor-link left" href="#integrations"><i class="icofont-laika">&#xef71;</i></a>Integrations</h2>
        
        <h3 id="laminar" class="section"><a class="anchor-link left" href="#laminar"><i class="icofont-laika">&#xef71;</i></a>Laminar</h3>
        <p>See the <code>LaminarViz.simpleEmbed</code> function, to get started. It returns a div, which you can put, anywhere you want in your app. Here it&#39;s just added where it&#39;s constructed for the sake of simplicity.</p>
        <p>The only constraint, is that the div must have a well defined size and height.</p>
        <pre><code class="nohighlight"><span class="keyword">import</span><span> </span><span class="identifier">com</span><span>.</span><span class="identifier">raquo</span><span>.</span><span class="identifier">laminar</span><span>.</span><span class="identifier">api</span><span>.</span><span class="type-name">L</span><span>.</span><span class="identifier">_</span><span>
</span><span class="keyword">import</span><span> </span><span class="identifier">org</span><span>.</span><span class="identifier">scalajs</span><span>.</span><span class="identifier">dom</span><span>
</span><span class="keyword">import</span><span> </span><span class="identifier">viz</span><span>.</span><span class="identifier">extensions</span><span>.*
</span><span class="keyword">import</span><span> </span><span class="identifier">viz</span><span>.</span><span class="type-name">Utils</span><span>
</span><span class="keyword">import</span><span> </span><span class="identifier">viz</span><span>.</span><span class="type-name">LaminarViz</span><span>
</span><span class="keyword">import</span><span> </span><span class="identifier">viz</span><span>.</span><span class="identifier">vega</span><span>.</span><span class="identifier">plots</span><span>.{</span><span class="type-name">BarChart</span><span>, </span><span class="keyword">given</span><span>}

</span><span class="keyword">val</span><span> </span><span class="identifier">appContainer</span><span> = </span><span class="identifier">dom</span><span>.</span><span class="identifier">document</span><span>.</span><span class="identifier">querySelector</span><span>(</span><span class="string-literal">s&quot;#</span><span class="substitution">${node.id}</span><span class="string-literal">&quot;</span><span>)
</span><span class="identifier">node</span><span>.</span><span class="identifier">setAttribute</span><span>(</span><span class="string-literal">&quot;style&quot;</span><span>, </span><span class="string-literal">s&quot;width:50vmin;height:50vmin&quot;</span><span>)
</span><span class="identifier">renderOnDomContentLoaded</span><span>(</span><span class="identifier">appContainer</span><span>, </span><span class="identifier">chartExample</span><span>())

</span><span class="keyword">object</span><span> </span><span class="identifier">chartExample</span><span>:
  </span><span class="keyword">val</span><span> </span><span class="identifier">data</span><span> = </span><span class="type-name">Var</span><span>(</span><span class="type-name">List</span><span>(</span><span class="number-literal">2.4</span><span>, </span><span class="number-literal">3.4</span><span>, </span><span class="number-literal">5.1</span><span>, -</span><span class="number-literal">2.3</span><span>))
  </span><span class="keyword">val</span><span> </span><span class="identifier">chartDiv</span><span> = </span><span class="identifier">div</span><span>(
    </span><span class="identifier">width</span><span> := </span><span class="string-literal">&quot;40vmin&quot;</span><span>,
    </span><span class="identifier">height</span><span> := </span><span class="string-literal">&quot;40vmin&quot;</span><span>,
  )

  </span><span class="keyword">def</span><span> </span><span class="declaration-name">apply</span><span>(): </span><span class="type-name">Div</span><span> =
    </span><span class="identifier">div</span><span>(
      </span><span class="identifier">p</span><span>(</span><span class="string-literal">&quot;We want to make it as easy as possible, to build a chart and get our data into it.&quot;</span><span>),
      </span><span class="identifier">span</span><span>(</span><span class="string-literal">&quot;Here&#39;s a random data set: &quot;</span><span>),
      </span><span class="identifier">child</span><span>.</span><span class="identifier">text</span><span> &lt;-- </span><span class="identifier">data</span><span>.</span><span class="identifier">signal</span><span>.</span><span class="identifier">map</span><span> { </span><span class="identifier">data</span><span> =&gt;
        </span><span class="identifier">data</span><span>.</span><span class="identifier">mkString</span><span>(</span><span class="string-literal">&quot;[&quot;</span><span>, </span><span class="string-literal">&quot;,&quot;</span><span>, </span><span class="string-literal">&quot;]&quot;</span><span>)
      },
      </span><span class="identifier">p</span><span>(),
      </span><span class="identifier">button</span><span>(
        </span><span class="string-literal">&quot;Add a random number&quot;</span><span>,
        </span><span class="identifier">onClick</span><span> --&gt; {</span><span class="identifier">_</span><span>=&gt;</span><span class="identifier">data</span><span>.</span><span class="identifier">update</span><span>{</span><span class="identifier">data</span><span> =&gt;</span><span class="identifier">data</span><span> :+ </span><span class="identifier">scala</span><span>.</span><span class="identifier">util</span><span>.</span><span class="type-name">Random</span><span>.</span><span class="identifier">nextDouble</span><span>() * </span><span class="number-literal">5</span><span>}}),
      </span><span class="identifier">p</span><span>(),
      </span><span class="identifier">child</span><span> &lt;-- </span><span class="identifier">data</span><span>.</span><span class="identifier">signal</span><span>.</span><span class="identifier">map</span><span> { </span><span class="identifier">data</span><span> =&gt;
        </span><span class="keyword">val</span><span> </span><span class="identifier">barChart</span><span>: </span><span class="type-name">BarChart</span><span> = </span><span class="identifier">data</span><span>.</span><span class="identifier">plotBarChart</span><span>(</span><span class="type-name">List</span><span>(</span><span class="identifier">viz</span><span>.</span><span class="type-name">Utils</span><span>.</span><span class="identifier">fillDiv</span><span>))
        </span><span class="type-name">LaminarViz</span><span>.</span><span class="identifier">simpleEmbed</span><span>(</span><span class="identifier">barChart</span><span>, </span><span class="type-name">Some</span><span>(</span><span class="identifier">chartDiv</span><span>))
      },
      </span><span class="identifier">p</span><span>()
    )
  </span><span class="identifier">end</span><span> </span><span class="identifier">apply</span><span>
</span><span class="identifier">end</span><span> </span><span class="identifier">chartExample</span></code></pre>
        <div id="mdoc-html-run0" data-mdoc-js></div>
        <p>This works quickly and easily, but it has some downsides.</p>
        <ul>
          <li>Replot the whole chart, on every render.</li>
          <li>No interaction. The chart assumes, that the last thing you want to do with it, is get it on the screen.</li>
        </ul>
        <p>It turns out, we can do w whole lot better, with vega View ... in the following example. At the expense of a little complexity, our chart is now interactive!</p>
        <pre><code class="nohighlight"><span class="keyword">import</span><span> </span><span class="identifier">com</span><span>.</span><span class="identifier">raquo</span><span>.</span><span class="identifier">laminar</span><span>.</span><span class="identifier">api</span><span>.</span><span class="type-name">L</span><span>.*

</span><span class="keyword">import</span><span> </span><span class="identifier">org</span><span>.</span><span class="identifier">scalajs</span><span>.</span><span class="identifier">dom</span><span>
</span><span class="keyword">import</span><span> </span><span class="identifier">viz</span><span>.</span><span class="identifier">extensions</span><span>.*
</span><span class="keyword">import</span><span> </span><span class="identifier">viz</span><span>.</span><span class="type-name">Utils</span><span>
</span><span class="keyword">import</span><span> </span><span class="identifier">viz</span><span>.</span><span class="type-name">LaminarViz</span><span>
</span><span class="keyword">import</span><span> </span><span class="identifier">viz</span><span>.</span><span class="identifier">vega</span><span>.</span><span class="identifier">facades</span><span>.</span><span class="type-name">VegaView</span><span>
</span><span class="keyword">import</span><span> </span><span class="identifier">viz</span><span>.</span><span class="identifier">vega</span><span>.</span><span class="identifier">facades</span><span>.</span><span class="type-name">Helpers</span><span>.*
</span><span class="keyword">import</span><span> </span><span class="identifier">scala</span><span>.</span><span class="identifier">scalajs</span><span>.</span><span class="identifier">js</span><span>
</span><span class="keyword">import</span><span> </span><span class="identifier">js</span><span>.</span><span class="type-name">JSConverters</span><span>.*
</span><span class="keyword">import</span><span> </span><span class="identifier">scala</span><span>.</span><span class="identifier">util</span><span>.</span><span class="type-name">Random</span><span>

</span><span class="keyword">import</span><span> </span><span class="identifier">viz</span><span>.</span><span class="identifier">vega</span><span>.</span><span class="identifier">plots</span><span>.{</span><span class="type-name">BarChart</span><span>, </span><span class="keyword">given</span><span>}

</span><span class="keyword">val</span><span> </span><span class="identifier">appContainer</span><span> = </span><span class="identifier">dom</span><span>.</span><span class="identifier">document</span><span>.</span><span class="identifier">querySelector</span><span>(</span><span class="string-literal">s&quot;#</span><span class="substitution">${node.id}</span><span class="string-literal">&quot;</span><span>)
</span><span class="identifier">node</span><span>.</span><span class="identifier">setAttribute</span><span>(</span><span class="string-literal">&quot;style&quot;</span><span>, </span><span class="string-literal">s&quot;width:50vmin;height:50vmin&quot;</span><span>)
</span><span class="identifier">renderOnDomContentLoaded</span><span>(</span><span class="identifier">appContainer</span><span>, </span><span class="identifier">chartExample</span><span>())

</span><span class="keyword">def</span><span> </span><span class="declaration-name">textIfObject</span><span>(</span><span class="identifier">in</span><span>: </span><span class="identifier">js</span><span>.</span><span class="type-name">UndefOr</span><span>[</span><span class="identifier">js</span><span>.</span><span class="type-name">Dynamic</span><span>]): </span><span class="type-name">String</span><span> =
  </span><span class="keyword">if</span><span> </span><span class="identifier">in</span><span> == </span><span class="identifier">js</span><span>.</span><span class="identifier">undefined</span><span> </span><span class="keyword">then</span><span> </span><span class="string-literal">&quot;undefined&quot;</span><span>
  </span><span class="keyword">else</span><span> </span><span class="identifier">js</span><span>.</span><span class="type-name">JSON</span><span>.</span><span class="identifier">stringify</span><span>(</span><span class="identifier">in</span><span>.</span><span class="identifier">get</span><span>)


</span><span class="keyword">object</span><span> </span><span class="identifier">chartExample</span><span>:
  </span><span class="keyword">val</span><span> (</span><span class="identifier">chartDataClickedBus</span><span>, </span><span class="identifier">chartClickCallback</span><span>) = </span><span class="type-name">LaminarViz</span><span>.</span><span class="identifier">dataClickBus</span><span>
  </span><span class="keyword">val</span><span> (</span><span class="identifier">aSignalBus</span><span>, </span><span class="identifier">signalCallback</span><span>) = </span><span class="type-name">LaminarViz</span><span>.</span><span class="identifier">signalBus</span><span>
  </span><span class="keyword">val</span><span> </span><span class="identifier">data</span><span> = </span><span class="type-name">Var</span><span>(</span><span class="type-name">List</span><span>(</span><span class="number-literal">2.4</span><span>, </span><span class="number-literal">3.4</span><span>, </span><span class="number-literal">5.1</span><span>, -</span><span class="number-literal">2.3</span><span>))
  </span><span class="keyword">val</span><span> </span><span class="identifier">baseChart</span><span> = </span><span class="type-name">BarChart</span><span>(
    </span><span class="type-name">List</span><span>(
      </span><span class="identifier">viz</span><span>.</span><span class="type-name">Utils</span><span>.</span><span class="identifier">fillDiv</span><span>,
      </span><span class="identifier">viz</span><span>.</span><span class="type-name">Utils</span><span>.</span><span class="identifier">removeXAxis</span><span>,
      </span><span class="identifier">viz</span><span>.</span><span class="type-name">Utils</span><span>.</span><span class="identifier">removeYAxis</span><span>
    )
  )
  </span><span class="keyword">val</span><span> </span><span class="identifier">setDivSize</span><span> = </span><span class="identifier">div</span><span>(
    </span><span class="identifier">width</span><span> := </span><span class="string-literal">&quot;40vmin&quot;</span><span>,
    </span><span class="identifier">height</span><span> := </span><span class="string-literal">&quot;40vmin&quot;</span><span>,
  )

  </span><span class="keyword">def</span><span> </span><span class="declaration-name">apply</span><span>(): </span><span class="type-name">Div</span><span> =
    </span><span class="keyword">val</span><span> (</span><span class="identifier">chartDiv</span><span> : </span><span class="type-name">Div</span><span>, </span><span class="identifier">viewOpt</span><span>: </span><span class="type-name">Signal</span><span>[</span><span class="type-name">Option</span><span>[</span><span class="type-name">VegaView</span><span>]]) =
      </span><span class="type-name">LaminarViz</span><span>.</span><span class="identifier">viewEmbed</span><span>(</span><span class="identifier">baseChart</span><span>, </span><span class="type-name">Some</span><span>(</span><span class="identifier">setDivSize</span><span>))

    </span><span class="identifier">div</span><span>(
      </span><span class="identifier">viewOpt</span><span>.</span><span class="identifier">map</span><span>(</span><span class="identifier">_</span><span>.</span><span class="identifier">map</span><span>(</span><span class="identifier">vv</span><span> =&gt;
        </span><span class="identifier">vv</span><span>.</span><span class="identifier">safeAddSignalListener</span><span>(</span><span class="string-literal">&quot;tooltip&quot;</span><span>, </span><span class="identifier">signalCallback</span><span>)
        </span><span class="identifier">vv</span><span>.</span><span class="identifier">addEventListener</span><span>(</span><span class="string-literal">&quot;click&quot;</span><span>, </span><span class="identifier">chartClickCallback</span><span>)
        </span><span class="comment">// vv.addEventListener(&quot;click&quot;, dataPrintOnlyClickHandler)
</span><span>        </span><span class="comment">// vv.printState()
</span><span>      )) --&gt; </span><span class="type-name">Observer</span><span>(</span><span class="identifier">_</span><span> =&gt; ()),
      </span><span class="identifier">p</span><span>(</span><span class="string-literal">&quot;We also want to find a way, to interact with the chart&quot;</span><span>),
      </span><span class="identifier">span</span><span>(</span><span class="string-literal">&quot;Here&#39;s a random data set: &quot;</span><span>),
      </span><span class="identifier">child</span><span>.</span><span class="identifier">text</span><span> &lt;-- </span><span class="identifier">data</span><span>.</span><span class="identifier">signal</span><span>.</span><span class="identifier">map</span><span> { </span><span class="identifier">data</span><span> =&gt;
        </span><span class="identifier">data</span><span>.</span><span class="identifier">mkString</span><span>(</span><span class="string-literal">&quot;[&quot;</span><span>, </span><span class="string-literal">&quot;,&quot;</span><span>, </span><span class="string-literal">&quot;]&quot;</span><span>)
      },
      </span><span class="identifier">p</span><span>(
        </span><span class="identifier">button</span><span>(
          </span><span class="string-literal">&quot;Add a random number&quot;</span><span>,
          </span><span class="identifier">onClick</span><span> --&gt; { </span><span class="identifier">_</span><span> =&gt;
            </span><span class="identifier">data</span><span>.</span><span class="identifier">update</span><span> { </span><span class="identifier">data</span><span> =&gt;
              </span><span class="identifier">data</span><span> :+ </span><span class="identifier">scala</span><span>.</span><span class="identifier">util</span><span>.</span><span class="type-name">Random</span><span>.</span><span class="identifier">nextDouble</span><span>() * </span><span class="number-literal">5</span><span>
            }
          }
        )
      ),
      </span><span class="identifier">data</span><span>.</span><span class="identifier">signal</span><span>.</span><span class="identifier">combineWith</span><span>(</span><span class="identifier">viewOpt</span><span>) --&gt; </span><span class="type-name">Observer</span><span> {
        (</span><span class="identifier">in</span><span>: (</span><span class="type-name">List</span><span>[</span><span class="type-name">Double</span><span>], </span><span class="type-name">Option</span><span>[</span><span class="type-name">VegaView</span><span>])) =&gt;
        </span><span class="keyword">val</span><span> </span><span class="identifier">data</span><span> = </span><span class="identifier">in</span><span class="number-literal">._1</span><span>
        </span><span class="keyword">val</span><span> </span><span class="identifier">theView</span><span> = </span><span class="identifier">in</span><span class="number-literal">._2</span><span>
        </span><span class="identifier">theView</span><span>.</span><span class="identifier">foreach</span><span> { </span><span class="identifier">view</span><span> =&gt;
          </span><span class="keyword">val</span><span> </span><span class="identifier">dataJs</span><span>: </span><span class="identifier">scala</span><span>.</span><span class="identifier">scalajs</span><span>.</span><span class="identifier">js</span><span>.</span><span class="type-name">Array</span><span>[</span><span class="identifier">js</span><span>.</span><span class="type-name">Object</span><span>] = </span><span class="identifier">data</span><span>
            .</span><span class="identifier">map</span><span>(</span><span class="identifier">d</span><span> =&gt;
              </span><span class="identifier">js</span><span>.</span><span class="type-name">Dynamic</span><span>.</span><span class="identifier">literal</span><span>(
                </span><span class="identifier">category</span><span> = </span><span class="type-name">Random</span><span>.</span><span class="identifier">alphanumeric</span><span>.</span><span class="identifier">take</span><span>(</span><span class="number-literal">8</span><span>).</span><span class="identifier">mkString</span><span>(</span><span class="string-literal">&quot;&quot;</span><span>),
                </span><span class="identifier">amount</span><span> = </span><span class="identifier">d</span><span>
              )
            )
            .</span><span class="identifier">toJSArray</span><span>
          </span><span class="identifier">view</span><span>.</span><span class="identifier">data</span><span>(</span><span class="string-literal">&quot;table&quot;</span><span>, </span><span class="identifier">dataJs</span><span>)
          </span><span class="identifier">view</span><span>.</span><span class="identifier">runAsync</span><span>() </span><span class="comment">// Don&#39;t forget this or nothing happens :-)
</span><span>        }

      },
      </span><span class="identifier">chartDiv</span><span>,
      </span><span class="identifier">p</span><span>(</span><span class="string-literal">&quot;You last clicked on : &quot;</span><span>, </span><span class="identifier">child</span><span>.</span><span class="identifier">text</span><span> &lt;-- </span><span class="identifier">chartDataClickedBus</span><span>.</span><span class="identifier">map</span><span>(</span><span class="identifier">textIfObject</span><span>)),
      </span><span class="identifier">p</span><span>(</span><span class="string-literal">&quot;You last hovered on : &quot;</span><span>, </span><span class="identifier">child</span><span>.</span><span class="identifier">text</span><span> &lt;-- </span><span class="identifier">aSignalBus</span><span>.</span><span class="identifier">map</span><span>(</span><span class="identifier">textIfObject</span><span>)),
      </span><span class="identifier">p</span><span>(),</span><span class="identifier">p</span><span>(</span><span class="string-literal">&quot;&quot;</span><span>)
    )
  </span><span class="identifier">end</span><span> </span><span class="identifier">apply</span><span>
</span><span class="identifier">end</span><span> </span><span class="identifier">chartExample</span></code></pre>
        <div id="mdoc-html-run1" data-mdoc-js></div>
        <p>The key difference, is that we also return the vega view. Hover over, and click the chart items, and you&#39;ll see the data printed out. So we have &quot;bi-directional&quot; communication with the chart.</p>
        <p>Further, the chart itself, is &quot;updated&quot;, rather than thrown away and replotted every time.</p>
        <p>Finally, this sets out some low leverl building blocks. If you were to know they types of the things you wanted to plot, one could easily construct some higher level, more typesafe abstractions.</p>
        
        <h3 id="calico" class="section"><a class="anchor-link left" href="#calico"><i class="icofont-laika">&#xef71;</i></a>Calico</h3>
        <pre><code class="nohighlight"><span class="keyword">import</span><span> </span><span class="identifier">scala</span><span>.</span><span class="identifier">scalajs</span><span>.</span><span class="identifier">js</span><span>
</span><span class="keyword">import</span><span> </span><span class="identifier">scala</span><span>.</span><span class="identifier">scalajs</span><span>.</span><span class="identifier">js</span><span>.</span><span class="identifier">annotation</span><span>.*

</span><span class="keyword">import</span><span> </span><span class="identifier">viz</span><span>.</span><span class="identifier">extensions</span><span>.*
</span><span class="keyword">import</span><span> </span><span class="identifier">viz</span><span>.</span><span class="identifier">vega</span><span>.</span><span class="identifier">plots</span><span>.{</span><span class="type-name">BarChart</span><span>, </span><span class="keyword">given</span><span>}
</span><span class="keyword">import</span><span> </span><span class="identifier">calico</span><span>.*
</span><span class="keyword">import</span><span> </span><span class="identifier">calico</span><span>.</span><span class="identifier">html</span><span>.</span><span class="identifier">io</span><span>.{*, </span><span class="keyword">given</span><span>}
</span><span class="keyword">import</span><span> </span><span class="identifier">calico</span><span>.</span><span class="identifier">unsafe</span><span>.</span><span class="keyword">given</span><span>
</span><span class="keyword">import</span><span> </span><span class="identifier">calico</span><span>.</span><span class="identifier">syntax</span><span>.*
</span><span class="keyword">import</span><span> </span><span class="identifier">cats</span><span>.</span><span class="identifier">effect</span><span>.*
</span><span class="keyword">import</span><span> </span><span class="identifier">cats</span><span>.</span><span class="identifier">effect</span><span>.</span><span class="identifier">std</span><span>.</span><span class="type-name">Random</span><span>
</span><span class="keyword">import</span><span> </span><span class="identifier">fs2</span><span>.*
</span><span class="keyword">import</span><span> </span><span class="identifier">fs2</span><span>.</span><span class="identifier">concurrent</span><span>.*
</span><span class="keyword">import</span><span> </span><span class="identifier">fs2</span><span>.</span><span class="identifier">dom</span><span>.*
</span><span class="keyword">import</span><span> </span><span class="identifier">viz</span><span>.</span><span class="identifier">vega</span><span>.</span><span class="identifier">facades</span><span>.</span><span class="type-name">EmbedOptions</span><span>

</span><span class="identifier">calicoChart</span><span>.</span><span class="identifier">renderInto</span><span>(</span><span class="identifier">node</span><span>.</span><span class="identifier">asInstanceOf</span><span>[</span><span class="identifier">fs2</span><span>.</span><span class="identifier">dom</span><span>.</span><span class="type-name">Node</span><span>[</span><span class="type-name">IO</span><span>]]).</span><span class="identifier">useForever</span><span>.</span><span class="identifier">unsafeRunAndForget</span><span>()

</span><span class="keyword">def</span><span> </span><span class="declaration-name">calicoChart</span><span>: </span><span class="type-name">Resource</span><span>[</span><span class="type-name">IO</span><span>, </span><span class="type-name">HtmlElement</span><span>[</span><span class="type-name">IO</span><span>]] =
  </span><span class="type-name">SignallingRef</span><span>[</span><span class="type-name">IO</span><span>]
    .</span><span class="identifier">of</span><span>(</span><span class="type-name">List</span><span>(</span><span class="number-literal">2.4</span><span>, </span><span class="number-literal">3.4</span><span>, </span><span class="number-literal">5.1</span><span>, -</span><span class="number-literal">2.3</span><span>))
    .</span><span class="identifier">product</span><span>(</span><span class="type-name">Channel</span><span>.</span><span class="identifier">unbounded</span><span>[</span><span class="type-name">IO</span><span>, </span><span class="type-name">Int</span><span>])
    .</span><span class="identifier">toResource</span><span>
    .</span><span class="identifier">flatMap</span><span> { (</span><span class="identifier">data</span><span>: </span><span class="type-name">SignallingRef</span><span>[</span><span class="identifier">cats</span><span>.</span><span class="identifier">effect</span><span>.</span><span class="type-name">IO</span><span>, </span><span class="type-name">List</span><span>[</span><span class="type-name">Double</span><span>]], </span><span class="identifier">diff</span><span>) =&gt;
      </span><span class="identifier">div</span><span>(
        </span><span class="identifier">p</span><span>(</span><span class="string-literal">&quot;We want to make it as easy as possible, to build a chart&quot;</span><span>),
        </span><span class="identifier">span</span><span>(</span><span class="string-literal">&quot;Here&#39;s a random data set: &quot;</span><span>),
        </span><span class="identifier">data</span><span>.</span><span class="identifier">map</span><span>(</span><span class="identifier">in</span><span> =&gt; </span><span class="identifier">p</span><span>(</span><span class="identifier">in</span><span>.</span><span class="identifier">mkString</span><span>(</span><span class="string-literal">&quot;[&quot;</span><span>, </span><span class="string-literal">&quot;,&quot;</span><span>, </span><span class="string-literal">&quot;]&quot;</span><span>))),
        </span><span class="identifier">button</span><span>(
          </span><span class="string-literal">&quot;Add a random number&quot;</span><span>,
          </span><span class="identifier">onClick</span><span> --&gt; (
            </span><span class="identifier">_</span><span>.</span><span class="identifier">evalMap</span><span>(</span><span class="identifier">_</span><span> =&gt;
              </span><span class="type-name">Random</span><span>.</span><span class="identifier">scalaUtilRandom</span><span>[</span><span class="type-name">IO</span><span>].</span><span class="identifier">toResource</span><span>.</span><span class="identifier">use</span><span>(</span><span class="identifier">r</span><span> =&gt; </span><span class="identifier">r</span><span>.</span><span class="identifier">nextDouble</span><span>.</span><span class="identifier">map</span><span>(</span><span class="identifier">_</span><span> * </span><span class="number-literal">5</span><span>))
            ).</span><span class="identifier">foreach</span><span>(</span><span class="identifier">newD</span><span> =&gt;
              </span><span class="keyword">val</span><span> </span><span class="identifier">d</span><span> = </span><span class="identifier">data</span><span>.</span><span class="identifier">get</span><span>
              </span><span class="type-name">IO</span><span>.</span><span class="identifier">println</span><span>(</span><span class="identifier">newD</span><span>) &gt;&gt;
                </span><span class="identifier">data</span><span>.</span><span class="identifier">update</span><span>(</span><span class="identifier">_</span><span> :+ </span><span class="identifier">newD</span><span>).</span><span class="identifier">void</span><span>
            )
          )
        ),
        </span><span class="identifier">p</span><span>(</span><span class="string-literal">&quot;&quot;</span><span>),
        </span><span class="identifier">data</span><span>.</span><span class="identifier">map</span><span> { </span><span class="identifier">data</span><span> =&gt;
          </span><span class="keyword">val</span><span> </span><span class="identifier">barChart</span><span>: </span><span class="type-name">BarChart</span><span> = </span><span class="identifier">data</span><span>.</span><span class="identifier">plotBarChart</span><span>(
            </span><span class="type-name">List</span><span>(
              </span><span class="identifier">viz</span><span>.</span><span class="type-name">Utils</span><span>.</span><span class="identifier">fillDiv</span><span>,
              </span><span class="identifier">viz</span><span>.</span><span class="type-name">Utils</span><span>.</span><span class="identifier">removeYAxis</span><span>
            )
          )
          </span><span class="keyword">val</span><span> </span><span class="identifier">chartDiv</span><span> = </span><span class="identifier">div</span><span>(</span><span class="string-literal">&quot;&quot;</span><span>)
          </span><span class="identifier">chartDiv</span><span>.</span><span class="identifier">flatMap</span><span>{ </span><span class="identifier">d</span><span> =&gt;
            </span><span class="comment">// To my astonishment, this doesn&#39;t work...
</span><span>            </span><span class="comment">/* val dCheat = d.asInstanceOf[org.scalajs.dom.html.Div]
            dCheat.style.height = &quot;40vmin&quot;
            dCheat.style.width = &quot;40vmin&quot; */</span><span>
            </span><span class="comment">// end yuck
</span><span>
            </span><span class="comment">// I had to set the div size down in here. Then it worked.
</span><span>            </span><span class="identifier">viz</span><span>.</span><span class="type-name">CalicoViz</span><span>.</span><span class="identifier">viewEmbed</span><span>(</span><span class="identifier">barChart</span><span>, </span><span class="type-name">Some</span><span>(</span><span class="identifier">chartDiv</span><span>), </span><span class="type-name">Some</span><span>(</span><span class="type-name">EmbedOptions</span><span>)).</span><span class="identifier">map</span><span>(</span><span class="identifier">_</span><span class="number-literal">._1</span><span>)
          }
        }
      )
    }</span></code></pre>
        <div id="mdoc-html-run2" data-mdoc-js></div>
        
        <h3 id="mdoc" class="section"><a class="anchor-link left" href="#mdoc"><i class="icofont-laika">&#xef71;</i></a>MDoc</h3>
        <p>Is how this documentation works. Setup mdoc with scalajs bundler, and include vega in the bundle. Read the source of this library :-).</p>
        
        <h3 id="laika-with-mdoc" class="section"><a class="anchor-link left" href="#laika-with-mdoc"><i class="icofont-laika">&#xef71;</i></a>Laika with mdoc</h3>
        <p>Which are a formiddable documentation team. You may need to also work with Laika docs it&#39;s <a href="https://planet42.github.io/Laika/0.18/02-running-laika/01-sbt-plugin.html">documentation</a>. This seciton is here to remind me to;</p>
        <ol class="arabic">
          <li>disable auto linking (otherwise you&#39;ll end up with two sets of imports)</li>
          <li>enable raw content</li>
        </ol>
        <pre><code>laikaConfig ~= { _.withRawContent },

and
tlSiteHeliumConfig := {
  .site
  // NOTE: Needed for Javasriptin in Laika
  .autoLinkJS()
}</code></pre>
        <p>The github repo of this documentation is a successful example!</p>
        
        <h1 id="conclusion" class="section"><a class="anchor-link left" href="#conclusion"><i class="icofont-laika">&#xef71;</i></a>Conclusion</h1>
        <p>The charts in these documents, are displayed using scala JS :-).</p>
        <p>What turns out to be really nice about scala JS support, is the seamless transition between exploration in a repl  on the JVM, luxuriating in it&#39;s rapid feedback and typsafe tooling, and subsequent publication into a browser with scala JS. It&#39;s the same code! There is a only a little more ceremony than with a repl - we need to decide the charts position in the document. i.e. find it a parent.</p>
        <p><mark>Gotcha : dedav <strong><em>does not include</em></strong> the underlying JS libraries out of it&#39;s box</mark>.</p>
        
        <h2 id="javascript-libraries" class="section"><a class="anchor-link left" href="#javascript-libraries"><i class="icofont-laika">&#xef71;</i></a>Javascript libraries</h2>
        <p>The example dependency is set out above. It <em>should</em> work with <em>any</em> bundling solution, or even by directly embedding the dependancies in the header of the html. Your choice.</p>
        <p>The <del>burden</del> freedom is left to you to get vega itself in scope. The simplest package.json depedancies would be;</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="attribute-name">&quot;dependencies&quot;</span><span>: {
    </span><span class="attribute-name">&quot;vega-embed&quot;</span><span> : </span><span class="string-literal">&quot;6.20.8&quot;</span><span>
}</span></code></pre>
        <p>You could also consider going sans-bundler via ESM modules or directly via a script tag in the header of your html - have a look at the source of this page for such an example.
        <script type="text/javascript" src="scalaJS.md.js" defer></script>
        <script type="text/javascript" src="mdoc.js" defer></script></p>

        <hr style="margin-top: 30px"/>
        <footer style="font-size: 90%; text-align: center">
          Dedav4s is distributed under the <a href="https://www.apache.org/licenses/LICENSE-2.0.txt">Apache-2.0</a> license.
        </footer>

      </main>

    </div>

  </body>
</html>